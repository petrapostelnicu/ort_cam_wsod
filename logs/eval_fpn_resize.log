Running on Quadro T1000 with Max-Q Design
Model loaded from pretrained_models/fpn_classifier_pascal_2007_final_layer0.pth
Evaluation: 100%|██████████| 4952/4952 [16:55<00:00,  4.88it/s]
Evaluation:   0%|          | 0/4952 [00:00<?, ?it/s]Evaluation time saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer0.csv
Evaluation: 100%|██████████| 4952/4952 [02:55<00:00, 28.15it/s]
-----------------------------------------------------------------------------
Evaluating data split full_dataset:
mAP pin pointing saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer0.csv
Pin Pointing AP per class: {1: 0.8217821782178217, 2: 0.9396488544048898, 3: 0.6138613861386139, 4: 0.591959391807848, 5: 0.5835646902302819, 6: 0.9526423920037425, 7: 0.7722772277227723, 8: 0.9873990201952331, 9: 0.8016759757935794, 10: 0.6237623762376238, 11: 0.9664326962867884, 12: 0.9009694288844334, 13: 0.8906064615613096, 14: 0.7821099351314441, 15: 0.6237623762376238, 16: 0.594059405940594, 17: 0.5445544554455446, 18: 0.9959186323742775, 19: 0.9842725432045735, 20: 0.8821903749947525}
Pin Pointing mAP: 0.7926724901406874
------------------
mAP detection saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer0.csv
Detection mAP: {'map': tensor(0.1213), 'map_50': tensor(0.1213), 'map_75': tensor(-1.), 'map_small': tensor(0.0001), 'map_medium': tensor(0.0091), 'map_large': tensor(0.3159), 'mar_1': tensor(0.1889), 'mar_10': tensor(0.2376), 'mar_100': tensor(0.2376), 'mar_small': tensor(0.0008), 'mar_medium': tensor(0.0424), 'mar_large': tensor(0.5284), 'map_per_class': tensor([0.1990, 0.0959, 0.1037, 0.0154, 0.0080, 0.1845, 0.1077, 0.3388, 0.0021,
        0.0649, 0.2141, 0.2025, 0.2302, 0.2328, 0.0323, 0.0193, 0.0203, 0.1167,
        0.2279, 0.0089]), 'mar_100_per_class': tensor([0.3441, 0.2699, 0.1823, 0.0738, 0.0228, 0.3583, 0.2206, 0.5324, 0.0328,
        0.1337, 0.3980, 0.3774, 0.3772, 0.3550, 0.1245, 0.0760, 0.0772, 0.3308,
        0.4106, 0.0554]), 'classes': tensor([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
        19, 20], dtype=torch.int32)}
------------------
mAP classification saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer0.csv
Classification mAP: 0.8757764101028442
Classification AP: tensor([   nan, 0.9764, 0.9375, 0.9381, 0.9541, 0.6155, 0.9049, 0.9277, 0.9420,
        0.7266, 0.8528, 0.8280, 0.9335, 0.9576, 0.9137, 0.9613, 0.6597, 0.8897,
        0.7606, 0.9718, 0.8641])
D:\_main_\TUD_bsc_3\RP\rp_env\lib\site-packages\torchmetrics\utilities\prints.py:43: UserWarning: Average precision score for one or more classes was `nan`. Ignoring these classes in macro-average
  warnings.warn(*args, **kwargs)  # noqa: B028
-----------------------------------------------------------------------------
Evaluating data split localization_dataset:
mAP pin pointing saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer0.csv
Pin Pointing AP per class: {1: 0.9575658933531738, 2: 0.9954117362955808, 3: 0.9985965913003236, 4: 0.9268841068386131, 5: 0.8430475666614282, 6: 0.9936849879319916, 7: 0.9800863545001116, 8: 0.9998571972581873, 9: 0.9287065401080198, 10: 0.9928803364207391, 11: 1.0, 12: 0.9999541620828749, 13: 0.9933319862598503, 14: 0.9702970297029703, 15: 0.9955932009385909, 16: 0.9783495390022243, 17: 0.9913366336633663, 18: 0.9833662822646075, 19: 0.9760897213310089, 20: 0.9618053798606649}
Pin Pointing mAP: 0.9733422622887163
------------------
mAP detection saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer0.csv
Detection mAP: {'map': tensor(0.3390), 'map_50': tensor(0.3390), 'map_75': tensor(-1.), 'map_small': tensor(0.), 'map_medium': tensor(0.0315), 'map_large': tensor(0.5409), 'mar_1': tensor(0.4515), 'mar_10': tensor(0.5594), 'mar_100': tensor(0.5594), 'mar_small': tensor(0.), 'mar_medium': tensor(0.1070), 'mar_large': tensor(0.7059), 'map_per_class': tensor([0.3169, 0.5084, 0.2809, 0.0862, 0.1648, 0.4752, 0.3805, 0.5029, 0.0092,
        0.3470, 0.5733, 0.3114, 0.4597, 0.6361, 0.3506, 0.3842, 0.2597, 0.4026,
        0.2954, 0.0356]), 'mar_100_per_class': tensor([0.4884, 0.8571, 0.4628, 0.2759, 0.2609, 0.6923, 0.6530, 0.7463, 0.2143,
        0.5000, 0.8000, 0.5349, 0.6053, 0.7692, 0.6875, 0.6765, 0.5600, 0.7593,
        0.4912, 0.1538]), 'classes': tensor([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
        19, 20], dtype=torch.int32)}
------------------
mAP classification saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer0.csv
Classification mAP: 0.9042474627494812
Classification AP: tensor([   nan, 0.9777, 0.9939, 0.9807, 0.9785, 0.6649, 0.9509, 0.9827, 0.9927,
        0.3350, 0.8830, 0.8242, 0.9883, 0.9244, 0.9120, 0.9700, 0.9083, 0.9543,
        0.9162, 0.9917, 0.9555])
-----------------------------------------------------------------------------
Evaluating data split small_localization_dataset:
mAP pin pointing saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer0.csv
Pin Pointing AP per class: {1: 0.7175517551755175, 2: 0.7655351249410653, 3: 0.9065665870480357, 4: 0.802949753103389, 5: 0.37384397780437384, 6: 0.8285242809995285, 7: 0.8994634418451753, 8: 0.8098961940461963, 9: 0.6717242031759896, 10: 0.803960396039604, 11: 0.0, 12: 0.8967862215386969, 13: 1.0, 14: 0.0858085808580858, 15: 0.8997524752475248, 16: 0.844200848656294, 17: 0.969059405940594, 18: 0.6776677667766776, 19: 0.8121253209937884, 20: 0.7907715942020443}
Pin Pointing mAP: 0.7278093964196289
------------------
mAP detection saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer0.csv
Detection mAP: {'map': tensor(0.0470), 'map_50': tensor(0.0470), 'map_75': tensor(-1.), 'map_small': tensor(0.), 'map_medium': tensor(0.0710), 'map_large': tensor(0.1426), 'mar_1': tensor(0.1088), 'mar_10': tensor(0.1336), 'mar_100': tensor(0.1336), 'mar_small': tensor(0.), 'mar_medium': tensor(0.1070), 'mar_large': tensor(0.6233), 'map_per_class': tensor([ 1.7219e-03,  1.3861e-01,  1.6146e-02,  9.6595e-04,  2.7228e-02,
         1.5283e-01,  3.3753e-03,  3.2791e-02,  2.9121e-03,  2.5669e-03,
        -1.0000e+00,  1.2729e-01,  0.0000e+00,  0.0000e+00,  2.4465e-02,
         1.5666e-01,  1.1683e-01,  8.5809e-02,  4.1254e-04,  2.1216e-03]), 'mar_100_per_class': tensor([ 0.0385,  0.2222,  0.0870,  0.0333,  0.1000,  0.3000,  0.0423,  0.1786,
         0.1429,  0.0625, -1.0000,  0.3000,  0.0000,  0.0000,  0.0968,  0.4545,
         0.1818,  0.2500,  0.0189,  0.0286]), 'classes': tensor([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
        19, 20], dtype=torch.int32)}
------------------
mAP classification saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer0.csv
Classification mAP: 0.7530516386032104
Classification AP: tensor([   nan, 0.9814, 0.9014, 0.9426, 0.9792, 0.4332, 0.7705, 0.9702, 0.9309,
        0.4997, 0.7208,    nan, 0.9436, 0.3338, 0.0994, 0.7888, 0.7799, 0.9526,
        0.3552, 0.9857, 0.9393])
-----------------------------------------------------------------------------
Evaluating data split large_localization_dataset:
mAP pin pointing saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer0.csv
Pin Pointing AP per class: {1: 0.9968555760634971, 2: 1.0, 3: 0.9991749174917489, 4: 0.9576647319904403, 5: 0.9719218075653716, 6: 0.9872016296561711, 7: 1.0, 8: 0.9999443764601179, 9: 0.9900990099009904, 10: 0.9940068010596125, 11: 1.0, 12: 0.9998315473193808, 13: 1.0, 14: 0.9975247524752479, 15: 1.0, 16: 0.9979372937293727, 17: 1.0, 18: 0.9902266940032247, 19: 1.0, 20: 1.0}
Pin Pointing mAP: 0.994119456885759
------------------
mAP detection saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer0.csv
Detection mAP: {'map': tensor(0.4712), 'map_50': tensor(0.4712), 'map_75': tensor(-1.), 'map_small': tensor(-1.), 'map_medium': tensor(-1.), 'map_large': tensor(0.6133), 'mar_1': tensor(0.5663), 'mar_10': tensor(0.7045), 'mar_100': tensor(0.7045), 'mar_small': tensor(-1.), 'mar_medium': tensor(-1.), 'mar_large': tensor(0.7045), 'map_per_class': tensor([0.6600, 0.6149, 0.5237, 0.3495, 0.2618, 0.5599, 0.6247, 0.5763, 0.0317,
        0.5572, 0.5777, 0.3564, 0.5313, 0.7091, 0.4183, 0.4927, 0.5084, 0.4620,
        0.4927, 0.1156]), 'mar_100_per_class': tensor([0.7922, 0.9630, 0.6807, 0.5357, 0.3846, 0.7857, 0.8731, 0.8362, 0.2857,
        0.7188, 0.8000, 0.5886, 0.6970, 0.8571, 0.8012, 0.7826, 0.8571, 0.8478,
        0.7034, 0.3000]), 'classes': tensor([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
        19, 20], dtype=torch.int32)}
------------------
mAP classification saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer0.csv
Classification mAP: 0.9300093650817871
Classification AP: tensor([   nan, 0.9745, 0.9979, 0.9980, 0.9762, 0.8687, 0.9702, 0.9833, 0.9976,
        0.2089, 0.9483, 0.8426, 0.9960, 0.9690, 0.9796, 0.9935, 0.9708, 0.9761,
        0.9884, 0.9947, 0.9659])
-----------------------------------------------------------------------------
Evaluating data split multi_instance_dataset:
mAP pin pointing saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer0.csv
Pin Pointing AP per class: {1: 0.3846984698469847, 2: 0.7641714720922642, 3: 0.33633957455151464, 4: 0.3634963004238762, 5: 0.33663366336633666, 6: 0.7523590179530774, 7: 0.5148514851485149, 8: 0.7310959037080179, 9: 0.6305149852240818, 10: 0.49504950495049505, 11: 0.0, 12: 0.801980198019802, 13: 0.7121884602253329, 14: 0.6534653465346535, 15: 0.5841584158415841, 16: 0.5247524752475248, 17: 0.42574257425742573, 18: 0.6311971382814674, 19: 0.7227722772277227, 20: 0.7498179301212797}
Pin Pointing mAP: 0.5557642596510978
------------------
mAP detection saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer0.csv
Detection mAP: {'map': tensor(0.0393), 'map_50': tensor(0.0393), 'map_75': tensor(-1.), 'map_small': tensor(1.1580e-05), 'map_medium': tensor(0.0077), 'map_large': tensor(0.1485), 'mar_1': tensor(0.0606), 'mar_10': tensor(0.1030), 'mar_100': tensor(0.1030), 'mar_small': tensor(0.0005), 'mar_medium': tensor(0.0243), 'mar_large': tensor(0.3151), 'map_per_class': tensor([ 6.7530e-02,  1.5866e-01,  2.0964e-02,  3.3872e-03,  1.4144e-03,
         6.5042e-02,  2.5716e-02,  5.9899e-02,  7.7189e-04,  2.1739e-02,
        -1.0000e+00,  7.1519e-02,  1.8279e-02,  6.3366e-02,  2.2025e-02,
         1.1002e-02,  9.5853e-03,  4.4554e-02,  8.1346e-02,  0.0000e+00]), 'mar_100_per_class': tensor([ 0.1357,  0.2857,  0.0497,  0.0222,  0.0081,  0.1190,  0.0941,  0.1642,
         0.0134,  0.0582, -1.0000,  0.1806,  0.0769,  0.1951,  0.0946,  0.0476,
         0.0396,  0.2000,  0.1714,  0.0000]), 'classes': tensor([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
        19, 20], dtype=torch.int32)}
------------------
mAP classification saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer0.csv
Classification mAP: 0.8707948923110962
Classification AP: tensor([   nan, 0.9925, 0.8437, 0.9586, 0.9961, 0.9118, 0.7875, 0.9828, 0.9798,
        0.5882, 0.8996,    nan, 0.9266, 0.6533, 0.9302, 0.9901, 0.9441, 0.9463,
        0.3475, 0.9885, 0.8779])
-----------------------------------------------------------------------------
Evaluating data split multi_class_dataset:
mAP pin pointing saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer0.csv
Pin Pointing AP per class: {1: 0.9942878903274942, 2: 0.7920792079207921, 3: 0.2569952647438657, 4: 0.5725826681028758, 5: 0.5416696383087433, 6: 0.9061565556920137, 7: 0.6039603960396039, 8: 0.8779871963099924, 9: 0.7128712871287128, 10: 0.46467146714671465, 11: 0.9581022649737309, 12: 0.7227722772277227, 13: 0.831497059480384, 14: 0.7225393811221837, 15: 0.5742574257425742, 16: 0.46534653465346537, 17: 0.2871287128712871, 18: 0.998297414935383, 19: 0.979873397175783, 20: 0.7675796265345889}
Pin Pointing mAP: 0.7015327833218955
------------------
mAP detection saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer0.csv
Detection mAP: {'map': tensor(0.1058), 'map_50': tensor(0.1058), 'map_75': tensor(-1.), 'map_small': tensor(0.0009), 'map_medium': tensor(0.0137), 'map_large': tensor(0.2727), 'mar_1': tensor(0.1604), 'mar_10': tensor(0.2053), 'mar_100': tensor(0.2053), 'mar_small': tensor(0.0019), 'mar_medium': tensor(0.0514), 'mar_large': tensor(0.4803), 'map_per_class': tensor([0.4002, 0.0414, 0.0119, 0.0179, 0.0070, 0.1386, 0.0746, 0.1926, 0.0021,
        0.0307, 0.2073, 0.1658, 0.2357, 0.2227, 0.0212, 0.0033, 0.0025, 0.0795,
        0.2520, 0.0080]), 'mar_100_per_class': tensor([0.5952, 0.1443, 0.0349, 0.0727, 0.0181, 0.3125, 0.1533, 0.3367, 0.0309,
        0.0978, 0.3841, 0.2963, 0.3868, 0.3218, 0.1053, 0.0336, 0.0169, 0.2661,
        0.4590, 0.0403]), 'classes': tensor([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
        19, 20], dtype=torch.int32)}
------------------
mAP classification saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer0.csv
Classification mAP: 0.8214689493179321
Classification AP: tensor([   nan, 0.9560, 0.9248, 0.5100, 0.9161, 0.6092, 0.9150, 0.8736, 0.7665,
        0.8076, 0.7531, 0.8682, 0.8601, 0.9771, 0.9195, 0.9853, 0.5109, 0.7467,
        0.7998, 0.8861, 0.8438])
--------------------------------------------------------------------------------------------------
Evaluation on trainval set
Using downloaded and verified file: ../data/pascal_voc_2007\VOCtrainval_06-Nov-2007.tar
Extracting ../data/pascal_voc_2007\VOCtrainval_06-Nov-2007.tar to ../data/pascal_voc_2007
Running on Quadro T1000 with Max-Q Design
Model loaded from pretrained_models/fpn_classifier_pascal_2007_final_layer0.pth
Evaluation: 100%|██████████| 5011/5011 [34:33<00:00,  2.42it/s]
Evaluation time saved to logs/evaluate_train_fpn_classifier_pascal_2007_final_layer0.csv
-----------------------------------------------------------------------------
Evaluating data split full_dataset:
CorLoc saved to logs/evaluate_train_fpn_classifier_pascal_2007_final_layer0.csv
CorLoc per class: {9: 0.027982326951399118, 11: 0.1708185053380783, 7: 0.2561702127659575, 13: 0.4297520661157025, 15: 0.1814872594903796, 2: 0.21703296703296704, 8: 0.38857142857142857, 12: 0.319047619047619, 19: 0.39037433155080214, 1: 0.4586206896551724, 5: 0.03977272727272727, 20: 0.0583804143126177, 3: 0.3143507972665148, 14: 0.40406976744186046, 16: 0.08935361216730038, 4: 0.08754208754208755, 18: 0.13803088803088803, 6: 0.2133676092544987, 17: 0.13304721030042918, 10: 0.29245283018867924}
Mean CorLoc: 0.23051126751485543
-----------------------------------------------------------------------------
Evaluating data split localization_dataset:
CorLoc saved to logs/evaluate_train_fpn_classifier_pascal_2007_final_layer0.csv
CorLoc per class: {7: 0.43962848297213625, 2: 0.37254901960784315, 19: 0.4117647058823529, 12: 0.3772893772893773, 20: 0.08633093525179857, 3: 0.43661971830985913, 8: 0.4967532467532468, 15: 0.3654485049833887, 1: 0.5053763440860215, 4: 0.09782608695652174, 6: 0.3493975903614458, 9: 0.0392156862745098, 18: 0.18548387096774194, 10: 0.37142857142857144, 13: 0.6440677966101694, 14: 0.5409836065573771, 17: 0.22330097087378642, 5: 0.16666666666666666, 16: 0.1891891891891892, 11: 0.10526315789473684}
Mean CorLoc: 0.3202291764458371
-----------------------------------------------------------------------------
Evaluating data split small_localization_dataset:
CorLoc saved to logs/evaluate_train_fpn_classifier_pascal_2007_final_layer0.csv
CorLoc per class: {19: 0.0, 7: 0.05128205128205128, 20: 0.015873015873015872, 3: 0.125, 15: 0.022222222222222223, 8: 0.022222222222222223, 9: 0.010752688172043012, 18: 0.0, 6: 0.07692307692307693, 10: 0.03571428571428571, 14: 0.0, 1: 0.05970149253731343, 17: 0.034482758620689655, 4: 0.0, 12: 0.1891891891891892, 2: 0.13333333333333333, 5: 0.0, 13: 0.1, 16: 0.0, 11: 0.0}
Mean CorLoc: 0.04383481680447214
-----------------------------------------------------------------------------
Evaluating data split large_localization_dataset:
CorLoc saved to logs/evaluate_train_fpn_classifier_pascal_2007_final_layer0.csv
CorLoc per class: {7: 0.563265306122449, 2: 0.41379310344827586, 12: 0.4067796610169492, 3: 0.6923076923076923, 8: 0.5779467680608364, 1: 0.7563025210084033, 19: 0.5986842105263158, 4: 0.21428571428571427, 6: 0.47368421052631576, 15: 0.42578125, 20: 0.14473684210526316, 13: 0.7551020408163265, 5: 0.22916666666666666, 16: 0.24561403508771928, 10: 0.5952380952380952, 17: 0.2972972972972973, 14: 0.6111111111111112, 9: 0.08333333333333333, 18: 0.24731182795698925, 11: 0.25}
Mean CorLoc: 0.4290870843457878
-----------------------------------------------------------------------------
Evaluating data split multi_instance_dataset:
CorLoc saved to logs/evaluate_train_fpn_classifier_pascal_2007_final_layer0.csv
CorLoc per class: {9: 0.013157894736842105, 11: 0.011363636363636364, 8: 0.3191489361702128, 1: 0.24444444444444444, 19: 0.3, 16: 0.07246376811594203, 7: 0.236, 4: 0.0975609756097561, 15: 0.1794871794871795, 14: 0.44, 12: 0.2631578947368421, 6: 0.08888888888888889, 18: 0.07692307692307693, 20: 0.08333333333333333, 17: 0.06382978723404255, 3: 0.09523809523809523, 10: 0.3026315789473684, 13: 0.14285714285714285, 5: 0.07575757575757576, 2: 0.2}
Mean CorLoc: 0.16531221044221903
-----------------------------------------------------------------------------
Evaluating data split multi_class_dataset:
CorLoc saved to logs/evaluate_train_fpn_classifier_pascal_2007_final_layer0.csv
CorLoc per class: {13: 0.40636042402826855, 15: 0.16317567567567567, 12: 0.27666666666666667, 2: 0.1556420233463035, 1: 0.4745762711864407, 5: 0.012626262626262626, 11: 0.19157608695652173, 20: 0.0436046511627907, 8: 0.21176470588235294, 7: 0.16611295681063123, 3: 0.08, 14: 0.3682170542635659, 9: 0.028290993071593534, 4: 0.07317073170731707, 16: 0.0732484076433121, 18: 0.13488372093023257, 17: 0.05555555555555555, 6: 0.19157088122605365, 10: 0.19696969696969696, 19: 0.3883495145631068}
Mean CorLoc: 0.18461811401361738
Evaluation on test set
Using downloaded and verified file: ../data/pascal_voc_2007\VOCtest_06-Nov-2007.tar
Extracting ../data/pascal_voc_2007\VOCtest_06-Nov-2007.tar to ../data/pascal_voc_2007
Running on Quadro T1000 with Max-Q Design
Model loaded from pretrained_models/fpn_classifier_pascal_2007_final_layer1.pth
Evaluation: 100%|██████████| 4952/4952 [33:08<00:00,  2.49it/s]
Evaluation:   0%|          | 0/4952 [00:00<?, ?it/s]Evaluation time saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer1.csv
Evaluation: 100%|██████████| 4952/4952 [05:30<00:00, 15.01it/s]
-----------------------------------------------------------------------------
Evaluating data split full_dataset:
mAP pin pointing saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer1.csv
Pin Pointing AP per class: {1: 0.6831683168316832, 2: 0.7623762376237624, 3: 0.5247524752475248, 4: 0.5917422139769798, 5: 0.45544554455445546, 6: 0.9278248529151608, 7: 0.6831026230585144, 8: 0.8613861386138614, 9: 0.7615534243444914, 10: 0.7618640609947017, 11: 0.9575477514446266, 12: 0.900990099009901, 13: 0.7818916939925503, 14: 0.7623762376237624, 15: 0.5544554455445545, 16: 0.37623762376237624, 17: 0.504950495049505, 18: 0.9898484753153804, 19: 0.9584797017790334, 20: 0.7806546579244671}
Pin Pointing mAP: 0.7290324034803646
------------------
mAP detection saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer1.csv
Detection mAP: {'map': tensor(0.1416), 'map_50': tensor(0.1416), 'map_75': tensor(-1.), 'map_small': tensor(0.0002), 'map_medium': tensor(0.0107), 'map_large': tensor(0.3255), 'mar_1': tensor(0.2130), 'mar_10': tensor(0.2385), 'mar_100': tensor(0.2385), 'mar_small': tensor(0.0024), 'mar_medium': tensor(0.0319), 'mar_large': tensor(0.5458), 'map_per_class': tensor([0.2119, 0.1549, 0.1040, 0.0203, 0.0070, 0.1992, 0.1546, 0.3853, 0.0014,
        0.0597, 0.2638, 0.2696, 0.2961, 0.2199, 0.0552, 0.0241, 0.0239, 0.1548,
        0.2183, 0.0084]), 'mar_100_per_class': tensor([0.3344, 0.2956, 0.1753, 0.0865, 0.0228, 0.3465, 0.2343, 0.4757, 0.0313,
        0.1429, 0.4080, 0.4340, 0.4152, 0.3388, 0.1345, 0.0659, 0.0643, 0.3056,
        0.4040, 0.0554]), 'classes': tensor([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
        19, 20], dtype=torch.int32)}
------------------
mAP classification saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer1.csv
Classification mAP: 0.8648077845573425
Classification AP: tensor([   nan, 0.9671, 0.9348, 0.9405, 0.9363, 0.5978, 0.8813, 0.9231, 0.9422,
        0.7381, 0.8013, 0.8340, 0.9334, 0.9513, 0.8994, 0.9598, 0.6572, 0.8276,
        0.7624, 0.9714, 0.8374])
-----------------------------------------------------------------------------
Evaluating data split localization_dataset:
mAP pin pointing saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer1.csv
Pin Pointing AP per class: {1: 0.9586007948497629, 2: 0.9985439720442632, 3: 0.9780631017711167, 4: 0.9170973026377424, 5: 0.8096416784535596, 6: 0.9957888878848771, 7: 0.9826427726396482, 8: 0.9891570280672702, 9: 0.9543835777952946, 10: 0.9774647206897839, 11: 1.0, 12: 1.0, 13: 0.9695153725898905, 14: 0.9405940594059405, 15: 1.0, 16: 0.963932107496464, 17: 0.9528528736449526, 18: 0.9749045939076666, 19: 0.9686252207876977, 20: 0.9490127161306154}
Pin Pointing mAP: 0.9640410390398273
------------------
mAP detection saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer1.csv
Detection mAP: {'map': tensor(0.3902), 'map_50': tensor(0.3902), 'map_75': tensor(-1.), 'map_small': tensor(0.), 'map_medium': tensor(0.0204), 'map_large': tensor(0.5547), 'mar_1': tensor(0.5209), 'mar_10': tensor(0.5733), 'mar_100': tensor(0.5733), 'mar_small': tensor(0.), 'mar_medium': tensor(0.0730), 'mar_large': tensor(0.7373), 'map_per_class': tensor([0.3041, 0.7441, 0.2823, 0.0942, 0.1185, 0.3822, 0.4672, 0.5664, 0.0249,
        0.4611, 0.6278, 0.4371, 0.6408, 0.5538, 0.5768, 0.3809, 0.2921, 0.5703,
        0.2542, 0.0251]), 'mar_100_per_class': tensor([0.4961, 0.8730, 0.4574, 0.2931, 0.3913, 0.6538, 0.6791, 0.6585, 0.2500,
        0.6250, 0.8000, 0.6372, 0.6842, 0.6923, 0.7656, 0.5882, 0.5200, 0.7778,
        0.4854, 0.1385]), 'classes': tensor([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
        19, 20], dtype=torch.int32)}
------------------
mAP classification saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer1.csv
Classification mAP: 0.8931888341903687
Classification AP: tensor([   nan, 0.9754, 0.9935, 0.9792, 0.9561, 0.6281, 0.9311, 0.9871, 0.9824,
        0.3244, 0.8309, 0.8466, 0.9827, 0.9159, 0.9097, 0.9667, 0.9088, 0.9229,
        0.9024, 0.9871, 0.9326])
-----------------------------------------------------------------------------
Evaluating data split small_localization_dataset:
mAP pin pointing saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer1.csv
Pin Pointing AP per class: {1: 0.7804706137953318, 2: 0.7314356435643564, 3: 0.8595725371156958, 4: 0.7645483003491099, 5: 0.30143014301430143, 6: 0.8431995831162064, 7: 0.9387413490123828, 8: 0.6998708566508826, 9: 0.552784190225566, 10: 0.8291144499065289, 11: 0.0, 12: 0.8460493108134343, 13: 0.5544554455445545, 14: 0, 15: 0.8366472636274616, 16: 0.6225744552477226, 17: 0.9273980969525524, 18: 0.6926884996191927, 19: 0.7040467746258081, 20: 0.8057742000044766}
Pin Pointing mAP: 0.6645400856592782
------------------
mAP detection saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer1.csv
Detection mAP: {'map': tensor(0.0310), 'map_50': tensor(0.0310), 'map_75': tensor(-1.), 'map_small': tensor(0.), 'map_medium': tensor(0.0536), 'map_large': tensor(0.0553), 'mar_1': tensor(0.0795), 'mar_10': tensor(0.0915), 'mar_100': tensor(0.0915), 'mar_small': tensor(0.), 'mar_medium': tensor(0.0730), 'mar_large': tensor(0.4500), 'map_per_class': tensor([ 5.0774e-04,  9.0523e-02,  2.5303e-03,  0.0000e+00,  3.6304e-02,
         1.3614e-02,  1.9973e-03,  1.4206e-02,  1.3441e-02,  2.5669e-03,
        -1.0000e+00,  1.3960e-01,  2.0792e-01,  0.0000e+00,  2.6136e-02,
         3.7624e-02,  0.0000e+00,  0.0000e+00,  1.7219e-03,  0.0000e+00]), 'mar_100_per_class': tensor([ 0.0192,  0.2222,  0.0290,  0.0000,  0.1000,  0.1000,  0.0423,  0.1071,
         0.2143,  0.0625, -1.0000,  0.3250,  0.2000,  0.0000,  0.0968,  0.1818,
         0.0000,  0.0000,  0.0377,  0.0000]), 'classes': tensor([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
        19, 20], dtype=torch.int32)}
------------------
mAP classification saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer1.csv
Classification mAP: 0.7198805809020996
Classification AP: tensor([   nan, 0.9601, 0.8856, 0.9389, 0.9478, 0.3614, 0.7045, 0.9638, 0.9040,
        0.4136, 0.5592,    nan, 0.8996, 0.3876, 0.2819, 0.7079, 0.7019, 0.9062,
        0.3073, 0.9632, 0.8830])
-----------------------------------------------------------------------------
Evaluating data split large_localization_dataset:
mAP pin pointing saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer1.csv
Pin Pointing AP per class: {1: 0.9693917268174694, 2: 1.0, 3: 0.9974972009263714, 4: 0.9864769295462364, 5: 1.0, 6: 1.0, 7: 0.9986078639876793, 8: 0.999106634801411, 9: 0.9860221316249274, 10: 1.0, 11: 1.0, 12: 1.0, 13: 1.0, 14: 1.0, 15: 1.0, 16: 0.9962871287128712, 17: 0.9801980198019802, 18: 0.9963861386138614, 19: 0.9995839920126468, 20: 0.964919900375131}
Pin Pointing mAP: 0.9937238833610295
------------------
mAP detection saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer1.csv
Detection mAP: {'map': tensor(0.5687), 'map_50': tensor(0.5687), 'map_75': tensor(-1.), 'map_small': tensor(-1.), 'map_medium': tensor(-1.), 'map_large': tensor(0.6464), 'mar_1': tensor(0.6783), 'mar_10': tensor(0.7451), 'mar_100': tensor(0.7451), 'mar_small': tensor(-1.), 'mar_medium': tensor(-1.), 'mar_large': tensor(0.7451), 'map_per_class': tensor([0.7489, 0.8576, 0.5818, 0.4755, 0.1819, 0.4921, 0.7861, 0.6596, 0.0499,
        0.7690, 0.6278, 0.5128, 0.7072, 0.6163, 0.6818, 0.5649, 0.8139, 0.6899,
        0.4630, 0.0941]), 'mar_100_per_class': tensor([0.8182, 0.9815, 0.7059, 0.6071, 0.6154, 0.7857, 0.9086, 0.7458, 0.2857,
        0.9062, 0.8000, 0.7086, 0.7576, 0.7714, 0.8944, 0.7826, 0.9286, 0.9130,
        0.6864, 0.3000]), 'classes': tensor([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
        19, 20], dtype=torch.int32)}
------------------
mAP classification saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer1.csv
Classification mAP: 0.9313585162162781
Classification AP: tensor([   nan, 0.9868, 1.0000, 0.9995, 0.9762, 0.8433, 0.9595, 0.9927, 0.9910,
        0.2708, 0.9288, 0.8689, 0.9930, 0.9658, 0.9737, 0.9948, 0.9854, 0.9373,
        0.9883, 0.9958, 0.9757])
-----------------------------------------------------------------------------
Evaluating data split multi_instance_dataset:
mAP pin pointing saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer1.csv
Pin Pointing AP per class: {1: 0.3069306930693069, 2: 0.5742574257425742, 3: 0.26732673267326734, 4: 0.30664370784904577, 5: 0.19801980198019803, 6: 0.8083117923339875, 7: 0.48514851485148514, 8: 0.6435643564356436, 9: 0.619809477475383, 10: 0.5742574257425742, 11: 0.0, 12: 0.801980198019802, 13: 0.5346534653465347, 14: 0.6534653465346535, 15: 0.5247524752475248, 16: 0.3465346534653465, 17: 0.36633663366336633, 18: 0.6680163562914996, 19: 0.603060306030603, 20: 0.5814271082280642}
Pin Pointing mAP: 0.493224823549043
------------------
mAP detection saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer1.csv
Detection mAP: {'map': tensor(0.0519), 'map_50': tensor(0.0519), 'map_75': tensor(-1.), 'map_small': tensor(4.5838e-05), 'map_medium': tensor(0.0100), 'map_large': tensor(0.1645), 'mar_1': tensor(0.0752), 'mar_10': tensor(0.1059), 'mar_100': tensor(0.1059), 'mar_small': tensor(0.0005), 'mar_medium': tensor(0.0152), 'mar_large': tensor(0.3316), 'map_per_class': tensor([ 7.7228e-02,  1.7457e-01,  2.3102e-02,  4.0028e-03,  4.7148e-04,
         8.7603e-02,  5.8470e-02,  6.5412e-02,  2.6483e-03,  1.4637e-02,
        -1.0000e+00,  8.9132e-02,  7.6379e-02,  8.2253e-02,  3.3578e-02,
         1.7109e-02,  9.7650e-03,  3.8985e-02,  1.3002e-01,  0.0000e+00]), 'mar_100_per_class': tensor([ 0.1286,  0.2500,  0.0397,  0.0222,  0.0081,  0.1667,  0.1098,  0.1194,
         0.0336,  0.0529, -1.0000,  0.1944,  0.1026,  0.2195,  0.0859,  0.0519,
         0.0264,  0.2000,  0.2000,  0.0000]), 'classes': tensor([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
        19, 20], dtype=torch.int32)}
------------------
mAP classification saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer1.csv
Classification mAP: 0.8838704824447632
Classification AP: tensor([   nan, 0.9781, 0.8626, 0.9726, 0.9807, 0.9039, 0.8606, 0.9813, 0.9896,
        0.6982, 0.8697,    nan, 0.9459, 0.7353, 0.9472, 0.9929, 0.9336, 0.9141,
        0.3314, 0.9910, 0.9049])
-----------------------------------------------------------------------------
Evaluating data split multi_class_dataset:
mAP pin pointing saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer1.csv
Pin Pointing AP per class: {1: 0.9185643564356436, 2: 0.6534653465346535, 3: 0.21876473361621876, 4: 0.6304754099927367, 5: 0.4398912562436207, 6: 0.8584708415786142, 7: 0.5740995511851869, 8: 0.6732673267326733, 9: 0.7027532768801122, 10: 0.5244084187469483, 11: 0.9483387360820359, 12: 0.7227722772277227, 13: 0.7524752475247525, 14: 0.693069306930693, 15: 0.504950495049505, 16: 0.25742574257425743, 17: 0.2376237623762376, 18: 0.9900990099009901, 19: 0.9572528681439573, 20: 0.6554806389126038}
Pin Pointing mAP: 0.6456824301334582
------------------
mAP detection saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer1.csv
Detection mAP: {'map': tensor(0.1292), 'map_50': tensor(0.1292), 'map_75': tensor(-1.), 'map_small': tensor(0.0002), 'map_medium': tensor(0.0136), 'map_large': tensor(0.2918), 'mar_1': tensor(0.1794), 'mar_10': tensor(0.2020), 'mar_100': tensor(0.2020), 'mar_small': tensor(0.0023), 'mar_medium': tensor(0.0333), 'mar_large': tensor(0.4752), 'map_per_class': tensor([0.5057, 0.0683, 0.0191, 0.0318, 0.0069, 0.1866, 0.1112, 0.2454, 0.0010,
        0.0272, 0.2560, 0.1885, 0.3015, 0.2092, 0.0419, 0.0031, 0.0066, 0.0984,
        0.2685, 0.0069]), 'mar_100_per_class': tensor([0.5238, 0.1779, 0.0349, 0.1091, 0.0104, 0.2937, 0.1612, 0.3367, 0.0259,
        0.0761, 0.3945, 0.3251, 0.4214, 0.3080, 0.1168, 0.0214, 0.0169, 0.2324,
        0.4098, 0.0444]), 'classes': tensor([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
        19, 20], dtype=torch.int32)}
------------------
mAP classification saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer1.csv
Classification mAP: 0.8038972616195679
Classification AP: tensor([   nan, 0.9246, 0.9248, 0.5087, 0.9075, 0.5800, 0.8882, 0.8644, 0.7945,
        0.8044, 0.6851, 0.8722, 0.8654, 0.9698, 0.9013, 0.9846, 0.5164, 0.5862,
        0.7982, 0.8938, 0.8078])
--------------------------------------------------------------------------------------------------
Evaluation on trainval set
Using downloaded and verified file: ../data/pascal_voc_2007\VOCtrainval_06-Nov-2007.tar
Extracting ../data/pascal_voc_2007\VOCtrainval_06-Nov-2007.tar to ../data/pascal_voc_2007
Running on Quadro T1000 with Max-Q Design
Model loaded from pretrained_models/fpn_classifier_pascal_2007_final_layer1.pth
Evaluation: 100%|██████████| 5011/5011 [34:43<00:00,  2.41it/s]
Evaluation time saved to logs/evaluate_train_fpn_classifier_pascal_2007_final_layer1.csv
-----------------------------------------------------------------------------
Evaluating data split full_dataset:
CorLoc saved to logs/evaluate_train_fpn_classifier_pascal_2007_final_layer1.csv
CorLoc per class: {9: 0.03287671232876712, 11: 0.2634730538922156, 7: 0.2917795844625113, 13: 0.47337278106508873, 15: 0.24716855429713525, 2: 0.3181818181818182, 8: 0.5514285714285714, 12: 0.40535714285714286, 19: 0.41025641025641024, 1: 0.5018867924528302, 20: 0.0584958217270195, 3: 0.4022038567493113, 5: 0.05952380952380952, 14: 0.44983818770226536, 16: 0.15017064846416384, 4: 0.1183206106870229, 18: 0.2084592145015106, 6: 0.2222222222222222, 10: 0.1744186046511628, 17: 0.1320754716981132}
Mean CorLoc: 0.2735754934574545
-----------------------------------------------------------------------------
Evaluating data split localization_dataset:
CorLoc saved to logs/evaluate_train_fpn_classifier_pascal_2007_final_layer1.csv
CorLoc per class: {7: 0.484375, 2: 0.5753424657534246, 19: 0.46632124352331605, 12: 0.5084033613445378, 20: 0.11214953271028037, 3: 0.5281385281385281, 8: 0.6531531531531531, 15: 0.4603174603174603, 1: 0.5798816568047337, 4: 0.11627906976744186, 6: 0.38666666666666666, 9: 0.020689655172413793, 18: 0.375, 10: 0.21476510067114093, 13: 0.64, 14: 0.5757575757575758, 17: 0.2808988764044944, 5: 0.25, 16: 0.3541666666666667, 11: 0.13333333333333333}
Mean CorLoc: 0.38578196730925846
-----------------------------------------------------------------------------
Evaluating data split small_localization_dataset:
CorLoc saved to logs/evaluate_train_fpn_classifier_pascal_2007_final_layer1.csv
CorLoc per class: {19: 0.014925373134328358, 7: 0.049019607843137254, 20: 0.0, 3: 0.1368421052631579, 15: 0.01818181818181818, 8: 0.09375, 9: 0.0, 18: 0.0, 6: 0.03125, 10: 0.044444444444444446, 14: 0.18181818181818182, 1: 0.11666666666666667, 17: 0.03333333333333333, 4: 0.0, 12: 0.0975609756097561, 2: 0.2857142857142857, 5: 0.05555555555555555, 13: 0.1111111111111111, 16: 0.07692307692307693, 11: 0.0}
Mean CorLoc: 0.06735482677994267
-----------------------------------------------------------------------------
Evaluating data split large_localization_dataset:
CorLoc saved to logs/evaluate_train_fpn_classifier_pascal_2007_final_layer1.csv
CorLoc per class: {7: 0.6880733944954128, 2: 0.6440677966101694, 12: 0.5939086294416244, 3: 0.8014705882352942, 8: 0.7473684210526316, 1: 0.8348623853211009, 19: 0.7063492063492064, 4: 0.30303030303030304, 6: 0.6511627906976745, 9: 0.047619047619047616, 15: 0.583756345177665, 20: 0.2033898305084746, 13: 0.7560975609756098, 5: 0.35294117647058826, 16: 0.45714285714285713, 10: 0.28846153846153844, 14: 0.6545454545454545, 17: 0.4067796610169492, 18: 0.4918032786885246, 11: 0.4}
Mean CorLoc: 0.5306415132920063
-----------------------------------------------------------------------------
Evaluating data split multi_instance_dataset:
CorLoc saved to logs/evaluate_train_fpn_classifier_pascal_2007_final_layer1.csv
CorLoc per class: {9: 0.017699115044247787, 11: 0.029411764705882353, 8: 0.35135135135135137, 1: 0.2391304347826087, 19: 0.4583333333333333, 16: 0.125, 7: 0.2985781990521327, 4: 0.12658227848101267, 15: 0.25295508274231676, 14: 0.2222222222222222, 12: 0.3333333333333333, 6: 0.05660377358490566, 18: 0.1388888888888889, 20: 0.03571428571428571, 17: 0.019417475728155338, 3: 0.2, 10: 0.1588785046728972, 13: 0.15789473684210525, 2: 0.4, 5: 0.027777777777777776}
Mean CorLoc: 0.18248862791287287
-----------------------------------------------------------------------------
Evaluating data split multi_class_dataset:
CorLoc saved to logs/evaluate_train_fpn_classifier_pascal_2007_final_layer1.csv
CorLoc per class: {13: 0.4646840148698885, 15: 0.22303394929093254, 12: 0.3283018867924528, 2: 0.22596153846153846, 1: 0.48, 11: 0.2853982300884956, 20: 0.03571428571428571, 8: 0.38461538461538464, 7: 0.18229166666666666, 3: 0.14893617021276595, 5: 0.024193548387096774, 9: 0.03577371048252912, 14: 0.4398148148148148, 4: 0.1134020618556701, 18: 0.18864468864468864, 10: 0.125, 17: 0.05, 6: 0.20689655172413793, 16: 0.10067114093959731, 19: 0.2909090909090909}
Mean CorLoc: 0.2167121367235018
Evaluation on test set
Using downloaded and verified file: ../data/pascal_voc_2007\VOCtest_06-Nov-2007.tar
Extracting ../data/pascal_voc_2007\VOCtest_06-Nov-2007.tar to ../data/pascal_voc_2007
Running on Quadro T1000 with Max-Q Design
Model loaded from pretrained_models/fpn_classifier_pascal_2007_final_layer2.pth
Evaluation: 100%|██████████| 4952/4952 [32:16<00:00,  2.56it/s]
Evaluation time saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer2.csv
Evaluation: 100%|██████████| 4952/4952 [05:29<00:00, 15.01it/s]
-----------------------------------------------------------------------------
Evaluating data split full_dataset:
mAP pin pointing saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer2.csv
Pin Pointing AP per class: {1: 0.7519683856460024, 2: 0.8514851485148515, 3: 0.504950495049505, 4: 0.5629226392186584, 5: 0.41527762666376533, 6: 0.943717786755457, 7: 0.6820699407868124, 8: 0.9200610995505513, 9: 0.58903926748738, 10: 0.5831786303630363, 11: 0.9643799317924153, 12: 0.9101485038455878, 13: 0.8014161972126191, 14: 0.771965658104272, 15: 0.5504512276649417, 16: 0.640579670617233, 17: 0.39603960396039606, 18: 0.9787778794274121, 19: 0.9782233502136221, 20: 0.7956827460739493}
Pin Pointing mAP: 0.7296167894474233
------------------
mAP detection saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer2.csv
Detection mAP: {'map': tensor(0.1365), 'map_50': tensor(0.1365), 'map_75': tensor(-1.), 'map_small': tensor(8.0737e-06), 'map_medium': tensor(0.0164), 'map_large': tensor(0.3146), 'mar_1': tensor(0.2092), 'mar_10': tensor(0.2380), 'mar_100': tensor(0.2380), 'mar_small': tensor(0.0002), 'mar_medium': tensor(0.0613), 'mar_large': tensor(0.5195), 'map_per_class': tensor([0.2188, 0.1468, 0.0921, 0.0268, 0.0156, 0.2446, 0.1325, 0.4017, 0.0068,
        0.0617, 0.1914, 0.2483, 0.2172, 0.2045, 0.0449, 0.0272, 0.0264, 0.1405,
        0.2597, 0.0231]), 'mar_100_per_class': tensor([0.3473, 0.2956, 0.1597, 0.0865, 0.0304, 0.3780, 0.2323, 0.5135, 0.0378,
        0.1398, 0.3946, 0.3925, 0.3342, 0.3225, 0.1425, 0.0625, 0.0772, 0.3207,
        0.4139, 0.0776]), 'classes': tensor([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
        19, 20], dtype=torch.int32)}
------------------
mAP classification saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer2.csv
Classification mAP: 0.8785642385482788
Classification AP: tensor([   nan, 0.9795, 0.9337, 0.9432, 0.9496, 0.6143, 0.8936, 0.9280, 0.9449,
        0.7295, 0.8687, 0.8020, 0.9247, 0.9558, 0.9157, 0.9629, 0.6978, 0.9122,
        0.7668, 0.9754, 0.8730])
-----------------------------------------------------------------------------
Evaluating data split localization_dataset:
mAP pin pointing saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer2.csv
Pin Pointing AP per class: {1: 0.9280387809252388, 2: 1.0, 3: 0.9681443862503722, 4: 0.8989140845730689, 5: 0.8480069857598916, 6: 0.9966950441674896, 7: 0.9774764319150289, 8: 0.9993761821844451, 9: 0.8935432397585066, 10: 0.9416861976052677, 11: 1.0, 12: 0.9996448075300804, 13: 1.0, 14: 0.9674681753889672, 15: 0.9900990099009901, 16: 0.9779914704283483, 17: 0.9603960396039604, 18: 0.9739327504178988, 19: 0.9787463650091698, 20: 0.9728139916125695}
Pin Pointing mAP: 0.9636486971515644
------------------
mAP detection saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer2.csv
Detection mAP: {'map': tensor(0.3884), 'map_50': tensor(0.3884), 'map_75': tensor(-1.), 'map_small': tensor(0.), 'map_medium': tensor(0.0610), 'map_large': tensor(0.5389), 'mar_1': tensor(0.4969), 'mar_10': tensor(0.5525), 'mar_100': tensor(0.5525), 'mar_small': tensor(0.), 'mar_medium': tensor(0.1508), 'mar_large': tensor(0.6918), 'map_per_class': tensor([0.3251, 0.6293, 0.2518, 0.1339, 0.2402, 0.4984, 0.5212, 0.5571, 0.0186,
        0.4334, 0.5130, 0.3952, 0.3452, 0.5987, 0.4108, 0.4758, 0.4689, 0.5600,
        0.3266, 0.0641]), 'mar_100_per_class': tensor([0.5039, 0.8095, 0.4096, 0.3103, 0.3478, 0.6538, 0.7052, 0.6829, 0.1786,
        0.5625, 0.8000, 0.5767, 0.4737, 0.6410, 0.6927, 0.5588, 0.6400, 0.7963,
        0.4912, 0.2154]), 'classes': tensor([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
        19, 20], dtype=torch.int32)}
------------------
mAP classification saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer2.csv
Classification mAP: 0.8982486724853516
Classification AP: tensor([   nan, 0.9883, 0.9896, 0.9844, 0.9612, 0.6707, 0.9527, 0.9862, 0.9891,
        0.2677, 0.9025, 0.7364, 0.9805, 0.9004, 0.9413, 0.9730, 0.9174, 0.9674,
        0.9001, 0.9909, 0.9649])
-----------------------------------------------------------------------------
Evaluating data split small_localization_dataset:
mAP pin pointing saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer2.csv
Pin Pointing AP per class: {1: 0.6858661560447384, 2: 0.7325161087537325, 3: 0.8645290223981466, 4: 0.801060036208551, 5: 0.40594059405940597, 6: 0.9592312172393712, 7: 0.8928171975951649, 8: 0.7308855885588559, 9: 0.6413288206155942, 10: 0.7848184818481849, 11: 0.0, 12: 0.855148208319284, 13: 0.7515951595159516, 14: 0, 15: 0.9104882471005722, 16: 0.6996543060899495, 17: 0.8118811881188119, 18: 0.7210749646393209, 19: 0.8558238798461497, 20: 0.9114578994392847}
Pin Pointing mAP: 0.7008058538195534
------------------
mAP detection saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer2.csv
Detection mAP: {'map': tensor(0.0549), 'map_50': tensor(0.0549), 'map_75': tensor(-1.), 'map_small': tensor(0.), 'map_medium': tensor(0.1022), 'map_large': tensor(0.1085), 'mar_1': tensor(0.1483), 'mar_10': tensor(0.1616), 'mar_100': tensor(0.1616), 'mar_small': tensor(0.), 'mar_medium': tensor(0.1508), 'mar_large': tensor(0.5889), 'map_per_class': tensor([ 0.0021,  0.1460,  0.0149,  0.0010,  0.0363,  0.0951,  0.0846,  0.0313,
         0.0285,  0.0107, -1.0000,  0.2480,  0.0520,  0.0000,  0.0405,  0.0627,
         0.1040,  0.0751,  0.0037,  0.0057]), 'mar_100_per_class': tensor([ 0.0385,  0.2222,  0.0725,  0.0333,  0.1000,  0.3000,  0.2676,  0.1429,
         0.2143,  0.1250, -1.0000,  0.3750,  0.2000,  0.0000,  0.1613,  0.1818,
         0.2727,  0.2500,  0.0566,  0.0571]), 'classes': tensor([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
        19, 20], dtype=torch.int32)}
------------------
mAP classification saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer2.csv
Classification mAP: 0.7745202779769897
Classification AP: tensor([   nan, 0.9813, 0.8324, 0.9549, 0.9662, 0.5498, 0.8290, 0.9704, 0.9150,
        0.4726, 0.7546,    nan, 0.8925, 0.4050, 0.5744, 0.7799, 0.6793, 0.9323,
        0.3018, 0.9774, 0.9471])
-----------------------------------------------------------------------------
Evaluating data split large_localization_dataset:
mAP pin pointing saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer2.csv
Pin Pointing AP per class: {1: 0.9945495993546797, 2: 0.9996399639963996, 3: 0.9866564836371365, 4: 0.988247790296271, 5: 1.0, 6: 0.9986498649864987, 7: 0.9989124753721245, 8: 1.0, 9: 0.9570957095709575, 10: 0.997670355270821, 11: 1.0, 12: 0.9997193465693734, 13: 1.0, 14: 0.9983498349834987, 15: 0.9998785154589078, 16: 0.9962871287128712, 17: 1.0, 18: 0.9854361515885808, 19: 1.0, 20: 0.9926751295819236}
Pin Pointing mAP: 0.9946884174690019
------------------
mAP detection saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer2.csv
Detection mAP: {'map': tensor(0.5436), 'map_50': tensor(0.5436), 'map_75': tensor(-1.), 'map_small': tensor(-1.), 'map_medium': tensor(-1.), 'map_large': tensor(0.6049), 'mar_1': tensor(0.6304), 'mar_10': tensor(0.6931), 'mar_100': tensor(0.6931), 'mar_small': tensor(-1.), 'mar_medium': tensor(-1.), 'mar_large': tensor(0.6931), 'map_per_class': tensor([0.7309, 0.7359, 0.4540, 0.4475, 0.4147, 0.5949, 0.7564, 0.6392, 0.0159,
        0.6695, 0.5146, 0.4331, 0.3854, 0.6632, 0.4795, 0.6768, 0.8956, 0.6558,
        0.5341, 0.1746]), 'mar_100_per_class': tensor([0.8182, 0.9074, 0.6050, 0.6071, 0.5385, 0.7381, 0.8629, 0.7684, 0.1429,
        0.7812, 0.8000, 0.6229, 0.5152, 0.7143, 0.7950, 0.7391, 0.9286, 0.8913,
        0.6864, 0.4000]), 'classes': tensor([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
        19, 20], dtype=torch.int32)}
------------------
mAP classification saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer2.csv
Classification mAP: 0.921605110168457
Classification AP: tensor([   nan, 0.9932, 1.0000, 0.9986, 0.9514, 0.8233, 0.9662, 0.9898, 0.9969,
        0.1596, 0.9508, 0.7491, 0.9933, 0.9401, 0.9822, 0.9935, 0.9923, 0.9952,
        0.9856, 0.9946, 0.9764])
-----------------------------------------------------------------------------
Evaluating data split multi_instance_dataset:
mAP pin pointing saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer2.csv
Pin Pointing AP per class: {1: 0.3465346534653465, 2: 0.8217821782178217, 3: 0.24752475247524752, 4: 0.31408047899384534, 5: 0.19801980198019803, 6: 0.733966921014848, 7: 0.45544554455445546, 8: 0.6484594280096703, 9: 0.5966697303598933, 10: 0.38613861386138615, 11: 0.0, 12: 0.693069306930693, 13: 0.5346534653465347, 14: 0.7494749474947494, 15: 0.5199393481132748, 16: 0.49470512268618166, 17: 0.26732673267326734, 18: 0.7879103699843669, 19: 0.7524752475247525, 20: 0.44757558985712237}
Pin Pointing mAP: 0.49978761167718283
------------------
mAP detection saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer2.csv
Detection mAP: {'map': tensor(0.0481), 'map_50': tensor(0.0481), 'map_75': tensor(-1.), 'map_small': tensor(0.), 'map_medium': tensor(0.0144), 'map_large': tensor(0.1468), 'mar_1': tensor(0.0806), 'mar_10': tensor(0.1061), 'mar_100': tensor(0.1061), 'mar_small': tensor(0.), 'mar_medium': tensor(0.0276), 'mar_large': tensor(0.3120), 'map_per_class': tensor([ 8.6196e-02,  8.0858e-02,  1.6194e-02,  3.9832e-03,  4.7148e-04,
         1.0269e-01,  2.7479e-02,  9.9021e-02,  2.5996e-02,  1.6901e-02,
        -1.0000e+00,  1.2440e-01,  1.8346e-02,  1.0616e-01,  3.5538e-02,
         8.8667e-03,  6.9903e-03,  4.9315e-02,  9.9344e-02,  5.2110e-03]), 'mar_100_per_class': tensor([ 0.1429,  0.1786,  0.0430,  0.0178,  0.0040,  0.1429,  0.0843,  0.1940,
         0.0470,  0.0582, -1.0000,  0.2222,  0.0769,  0.1951,  0.1014,  0.0303,
         0.0220,  0.2000,  0.2143,  0.0417]), 'classes': tensor([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
        19, 20], dtype=torch.int32)}
------------------
mAP classification saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer2.csv
Classification mAP: 0.8734354972839355
Classification AP: tensor([   nan, 0.9811, 0.8711, 0.9572, 0.9883, 0.8740, 0.8274, 0.9878, 0.9890,
        0.5861, 0.9355,    nan, 0.9643, 0.5571, 0.9516, 0.9923, 0.9395, 0.9745,
        0.3656, 0.9953, 0.8575])
-----------------------------------------------------------------------------
Evaluating data split multi_class_dataset:
mAP pin pointing saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer2.csv
Pin Pointing AP per class: {1: 0.9158415841584159, 2: 0.7128712871287128, 3: 0.13556740289413557, 4: 0.6080227598993743, 5: 0.4300625843866173, 6: 0.9068054928449026, 7: 0.5626378245243316, 8: 0.7421728659352421, 9: 0.5214857644540437, 10: 0.4752475247524752, 11: 0.9535954988261839, 12: 0.7719645648775404, 13: 0.7720367178418248, 14: 0.7128234562586693, 15: 0.501612537731143, 16: 0.5581583169490004, 17: 0.3564356435643564, 18: 0.9827117990134296, 19: 0.9450937079706496, 20: 0.6783472734754726}
Pin Pointing mAP: 0.6621747303743261
------------------
mAP detection saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer2.csv
Detection mAP: {'map': tensor(0.1192), 'map_50': tensor(0.1192), 'map_75': tensor(-1.), 'map_small': tensor(1.0931e-05), 'map_medium': tensor(0.0164), 'map_large': tensor(0.2758), 'mar_1': tensor(0.1815), 'mar_10': tensor(0.2080), 'mar_100': tensor(0.2080), 'mar_small': tensor(0.0002), 'mar_medium': tensor(0.0600), 'mar_large': tensor(0.4747), 'map_per_class': tensor([0.4476, 0.0745, 0.0083, 0.0310, 0.0073, 0.2221, 0.0870, 0.2833, 0.0021,
        0.0206, 0.1844, 0.1611, 0.2285, 0.1758, 0.0355, 0.0089, 0.0156, 0.0860,
        0.2894, 0.0147]), 'mar_100_per_class': tensor([0.5476, 0.1980, 0.0233, 0.1091, 0.0285, 0.3500, 0.1651, 0.3776, 0.0334,
        0.0870, 0.3806, 0.2798, 0.3491, 0.2976, 0.1268, 0.0336, 0.0508, 0.2477,
        0.4262, 0.0484]), 'classes': tensor([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
        19, 20], dtype=torch.int32)}
------------------
mAP classification saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer2.csv
Classification mAP: 0.8227559924125671
Classification AP: tensor([   nan, 0.9368, 0.9221, 0.4935, 0.9179, 0.5963, 0.9020, 0.8714, 0.7861,
        0.8120, 0.7503, 0.8521, 0.8430, 0.9803, 0.9178, 0.9839, 0.5839, 0.7507,
        0.8044, 0.9044, 0.8462])
--------------------------------------------------------------------------------------------------
Evaluation on trainval set
Using downloaded and verified file: ../data/pascal_voc_2007\VOCtrainval_06-Nov-2007.tar
Extracting ../data/pascal_voc_2007\VOCtrainval_06-Nov-2007.tar to ../data/pascal_voc_2007
Running on Quadro T1000 with Max-Q Design
Evaluation:   0%|          | 0/5011 [00:00<?, ?it/s]Model loaded from pretrained_models/fpn_classifier_pascal_2007_final_layer2.pth
Evaluation: 100%|██████████| 5011/5011 [33:49<00:00,  2.47it/s]
Evaluation time saved to logs/evaluate_train_fpn_classifier_pascal_2007_final_layer2.csv
-----------------------------------------------------------------------------
Evaluating data split full_dataset:
CorLoc saved to logs/evaluate_train_fpn_classifier_pascal_2007_final_layer2.csv
CorLoc per class: {9: 0.06076923076923077, 7: 0.28991971454058874, 13: 0.4183381088825215, 15: 0.24096764059063777, 2: 0.2770700636942675, 8: 0.5075757575757576, 12: 0.39317773788150806, 19: 0.452991452991453, 1: 0.4548872180451128, 5: 0.06631299734748011, 11: 0.26356589147286824, 20: 0.09798994974874371, 3: 0.36363636363636365, 14: 0.39939024390243905, 16: 0.10930232558139535, 4: 0.1853448275862069, 18: 0.1782051282051282, 10: 0.2843601895734597, 17: 0.3148148148148148, 6: 0.3016949152542373}
Mean CorLoc: 0.28301572860471075
-----------------------------------------------------------------------------
Evaluating data split localization_dataset:
CorLoc saved to logs/evaluate_train_fpn_classifier_pascal_2007_final_layer2.csv
CorLoc per class: {7: 0.50814332247557, 2: 0.5373134328358209, 19: 0.49746192893401014, 12: 0.47346938775510206, 20: 0.18627450980392157, 3: 0.49372384937238495, 8: 0.6382978723404256, 15: 0.44166666666666665, 1: 0.5087719298245614, 4: 0.18421052631578946, 6: 0.46774193548387094, 9: 0.09090909090909091, 18: 0.2840909090909091, 10: 0.5087719298245614, 13: 0.4406779661016949, 14: 0.4117647058823529, 17: 0.5333333333333333, 5: 0.2653061224489796, 16: 0.27586206896551724, 11: 0.14285714285714285}
Mean CorLoc: 0.3945324315610853
-----------------------------------------------------------------------------
Evaluating data split small_localization_dataset:
CorLoc saved to logs/evaluate_train_fpn_classifier_pascal_2007_final_layer2.csv
CorLoc per class: {19: 0.1044776119402985, 7: 0.14285714285714285, 20: 0.06521739130434782, 3: 0.16, 15: 0.15217391304347827, 8: 0.14705882352941177, 9: 0.058823529411764705, 18: 0.0, 6: 0.17647058823529413, 10: 0.125, 14: 0.3333333333333333, 1: 0.016129032258064516, 17: 0.08333333333333333, 4: 0.0, 12: 0.21621621621621623, 2: 0.2, 5: 0.07142857142857142, 13: 0.3, 16: 0.047619047619047616, 11: 0.0}
Mean CorLoc: 0.1200069267255152
-----------------------------------------------------------------------------
Evaluating data split large_localization_dataset:
CorLoc saved to logs/evaluate_train_fpn_classifier_pascal_2007_final_layer2.csv
CorLoc per class: {7: 0.6457399103139013, 2: 0.6346153846153846, 12: 0.5192307692307693, 3: 0.7338129496402878, 8: 0.7213930348258707, 1: 0.7889908256880734, 19: 0.7, 4: 0.5, 6: 0.5777777777777777, 15: 0.5103092783505154, 20: 0.2857142857142857, 13: 0.46938775510204084, 5: 0.34285714285714286, 16: 0.40540540540540543, 10: 0.7878787878787878, 17: 0.696969696969697, 14: 0.41935483870967744, 9: 0.13513513513513514, 18: 0.32894736842105265, 11: 0.16666666666666666}
Mean CorLoc: 0.5185093506651236
-----------------------------------------------------------------------------
Evaluating data split multi_instance_dataset:
CorLoc saved to logs/evaluate_train_fpn_classifier_pascal_2007_final_layer2.csv
CorLoc per class: {9: 0.014705882352941176, 8: 0.4473684210526316, 1: 0.18, 19: 0.49019607843137253, 16: 0.13043478260869565, 7: 0.2822966507177033, 4: 0.17142857142857143, 15: 0.26948775055679286, 14: 0.35714285714285715, 12: 0.296875, 18: 0.25925925925925924, 20: 0.08823529411764706, 17: 0.11363636363636363, 3: 0.14285714285714285, 10: 0.2571428571428571, 13: 0.17647058823529413, 6: 0.15, 5: 0.043478260869565216, 2: 0.0, 11: 0.0}
Mean CorLoc: 0.19355078802048475
-----------------------------------------------------------------------------
Evaluating data split multi_class_dataset:
CorLoc saved to logs/evaluate_train_fpn_classifier_pascal_2007_final_layer2.csv
CorLoc per class: {13: 0.42857142857142855, 15: 0.2165196471531676, 12: 0.3387096774193548, 2: 0.21074380165289255, 1: 0.5555555555555556, 5: 0.03546099290780142, 11: 0.27892561983471076, 20: 0.0648854961832061, 8: 0.2764227642276423, 9: 0.06118881118881119, 7: 0.18181818181818182, 3: 0.11764705882352941, 14: 0.40086206896551724, 4: 0.19767441860465115, 18: 0.16090225563909774, 10: 0.15476190476190477, 17: 0.2631578947368421, 6: 0.2676056338028169, 16: 0.06785714285714285, 19: 0.34951456310679613}
Mean CorLoc: 0.23143924589055254
Evaluation on test set
Using downloaded and verified file: ../data/pascal_voc_2007\VOCtest_06-Nov-2007.tar
Extracting ../data/pascal_voc_2007\VOCtest_06-Nov-2007.tar to ../data/pascal_voc_2007
Running on Quadro T1000 with Max-Q Design
Model loaded from pretrained_models/fpn_classifier_pascal_2007_final_layer3.pth
Evaluation:  84%|████████▎ | 4137/4952 [26:19<05:26,  2.49it/s]D:\_main_\TUD_bsc_3\RP\weakly_supervised_object_detection_with_CAM\models\MyModel.py:727: RuntimeWarning: invalid value encountered in divide
  cam_normalized = cam_adjusted / cam_max
Evaluation: 100%|██████████| 4952/4952 [32:00<00:00,  2.58it/s]
Evaluation time saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer3.csv
Evaluation: 100%|██████████| 4952/4952 [05:31<00:00, 14.92it/s]
-----------------------------------------------------------------------------
Evaluating data split full_dataset:
mAP pin pointing saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer3.csv
Pin Pointing AP per class: {1: 0.7120590955448359, 2: 0.6860117855679323, 3: 0.4943009691180482, 4: 0.4549582722617543, 5: 0.37540665638183446, 6: 0.8593132478023922, 7: 0.5688681288579782, 8: 0.8878931283103105, 9: 0.43122086694451384, 10: 0.4859567589412002, 11: 0.8958664718272407, 12: 0.8586306151651084, 13: 0.7712448874632511, 14: 0.6695994720964816, 15: 0.3787683349342345, 16: 0.4106392052131283, 17: 0.38613861386138615, 18: 0.9090826231345284, 19: 0.9232809377282664, 20: 0.7207925109887205}
Pin Pointing mAP: 0.6440016291071572
------------------
mAP detection saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer3.csv
Detection mAP: {'map': tensor(0.1183), 'map_50': tensor(0.1183), 'map_75': tensor(-1.), 'map_small': tensor(0.), 'map_medium': tensor(0.0061), 'map_large': tensor(0.2636), 'mar_1': tensor(0.1966), 'mar_10': tensor(0.2125), 'mar_100': tensor(0.2125), 'mar_small': tensor(0.), 'mar_medium': tensor(0.0184), 'mar_large': tensor(0.4947), 'map_per_class': tensor([0.1615, 0.1376, 0.0646, 0.0154, 0.0122, 0.1560, 0.1217, 0.3451, 0.0022,
        0.0676, 0.1537, 0.2191, 0.2065, 0.1913, 0.0432, 0.0272, 0.0223, 0.1320,
        0.2750, 0.0112]), 'mar_100_per_class': tensor([0.3087, 0.2596, 0.1354, 0.0738, 0.0213, 0.2913, 0.2096, 0.4730, 0.0306,
        0.1185, 0.2943, 0.3528, 0.3418, 0.3008, 0.1144, 0.0608, 0.0643, 0.3131,
        0.4106, 0.0748]), 'classes': tensor([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
        19, 20], dtype=torch.int32)}
------------------
mAP classification saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer3.csv
Classification mAP: 0.8692105412483215
Classification AP: tensor([   nan, 0.9790, 0.9278, 0.9340, 0.9356, 0.6205, 0.8926, 0.9165, 0.9447,
        0.7251, 0.8338, 0.7975, 0.9103, 0.9562, 0.9000, 0.9601, 0.7233, 0.8549,
        0.7585, 0.9658, 0.8481])
-----------------------------------------------------------------------------
Evaluating data split localization_dataset:
mAP pin pointing saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer3.csv
Pin Pointing AP per class: {1: 0.8901771756122981, 2: 0.999690594059406, 3: 0.9529182560091218, 4: 0.842351536905112, 5: 0.8238561919852463, 6: 0.9915067701102094, 7: 0.9680611384183739, 8: 0.9864843525187671, 9: 0.8006298766522615, 10: 0.9221400179059609, 11: 1.0, 12: 0.9893502508145553, 13: 1.0, 14: 0.9503300330033002, 15: 0.9406703595266768, 16: 0.9261844894166836, 17: 0.9907297396406306, 18: 0.8862666439658534, 19: 0.9673075649024981, 20: 0.9425533360219216}
Pin Pointing mAP: 0.9385604163734438
------------------
mAP detection saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer3.csv
Detection mAP: {'map': tensor(0.3699), 'map_50': tensor(0.3699), 'map_75': tensor(-1.), 'map_small': tensor(0.), 'map_medium': tensor(0.0178), 'map_large': tensor(0.4798), 'mar_1': tensor(0.4961), 'mar_10': tensor(0.5246), 'mar_100': tensor(0.5246), 'mar_small': tensor(0.), 'mar_medium': tensor(0.0496), 'mar_large': tensor(0.6751), 'map_per_class': tensor([0.2206, 0.6633, 0.1668, 0.0814, 0.1959, 0.2797, 0.4273, 0.4870, 0.0249,
        0.4329, 0.7599, 0.3599, 0.4499, 0.7010, 0.5514, 0.3404, 0.4096, 0.4693,
        0.3539, 0.0219]), 'mar_100_per_class': tensor([0.4496, 0.7619, 0.3457, 0.2586, 0.3478, 0.5192, 0.6343, 0.6341, 0.2857,
        0.5000, 0.8000, 0.5349, 0.6053, 0.7179, 0.6979, 0.4412, 0.6000, 0.6852,
        0.5029, 0.1692]), 'classes': tensor([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
        19, 20], dtype=torch.int32)}
------------------
mAP classification saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer3.csv
Classification mAP: 0.8996006846427917
Classification AP: tensor([   nan, 0.9863, 0.9714, 0.9789, 0.9382, 0.7080, 0.9339, 0.9813, 0.9859,
        0.2965, 0.8875, 0.8824, 0.9745, 0.9009, 0.9309, 0.9660, 0.9218, 0.9095,
        0.8976, 0.9869, 0.9536])
-----------------------------------------------------------------------------
Evaluating data split small_localization_dataset:
mAP pin pointing saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer3.csv
Pin Pointing AP per class: {1: 0.7384262408174234, 2: 0.8106435643564357, 3: 0.7270473828566236, 4: 0.5816796738317853, 5: 0.3954738330975955, 6: 0.7957095709570956, 7: 0.8443091424044024, 8: 0.6855985598559856, 9: 0.41605654171555256, 10: 0.7179867986798681, 11: 0.0, 12: 0.8707370737073707, 13: 0.801980198019802, 14: 0.25742574257425743, 15: 0.6452687337821142, 16: 0.5764528626775722, 17: 0.7033592644978784, 18: 0.9195544554455444, 19: 0.7829308217765822, 20: 0.7988094461297216}
Pin Pointing mAP: 0.6534724953591804
------------------
mAP detection saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer3.csv
Detection mAP: {'map': tensor(0.0087), 'map_50': tensor(0.0087), 'map_75': tensor(-1.), 'map_small': tensor(0.), 'map_medium': tensor(0.0357), 'map_large': tensor(0.0258), 'mar_1': tensor(0.0579), 'mar_10': tensor(0.0626), 'mar_100': tensor(0.0626), 'mar_small': tensor(0.), 'mar_medium': tensor(0.0496), 'mar_large': tensor(0.3789), 'map_per_class': tensor([ 5.5006e-04,  0.0000e+00,  3.0941e-04,  2.8289e-03,  0.0000e+00,
         1.8152e-02,  2.8022e-03,  0.0000e+00,  2.6710e-02,  0.0000e+00,
        -1.0000e+00,  4.9005e-03,  2.5990e-02,  0.0000e+00,  1.2786e-02,
         3.3003e-02,  3.1353e-02,  0.0000e+00,  5.9841e-03,  0.0000e+00]), 'mar_100_per_class': tensor([ 0.0192,  0.0000,  0.0145,  0.0333,  0.0000,  0.1000,  0.0423,  0.0000,
         0.2857,  0.0000, -1.0000,  0.0500,  0.2000,  0.0000,  0.0968,  0.0909,
         0.1818,  0.0000,  0.0755,  0.0000]), 'classes': tensor([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
        19, 20], dtype=torch.int32)}
------------------
mAP classification saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer3.csv
Classification mAP: 0.7533160448074341
Classification AP: tensor([   nan, 0.9745, 0.7982, 0.9340, 0.9416, 0.5395, 0.7419, 0.9685, 0.8802,
        0.4152, 0.7729,    nan, 0.8628, 0.4965, 0.3606, 0.7266, 0.8019, 0.8401,
        0.3640, 0.9600, 0.9340])
-----------------------------------------------------------------------------
Evaluating data split large_localization_dataset:
mAP pin pointing saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer3.csv
Pin Pointing AP per class: {1: 0.9961888222639842, 2: 1.0, 3: 0.9770762738482215, 4: 0.9534653465346535, 5: 0.9724186704384726, 6: 0.9945994599459946, 7: 0.9996602601436615, 8: 0.9967226077717116, 9: 0.875, 10: 1.0, 11: 1.0, 12: 0.9992115290496197, 13: 1.0, 14: 0.9801632794858433, 15: 0.9792629578784634, 16: 0.9942878903274944, 17: 0.9947194719471949, 18: 0.8813701758112007, 19: 0.9962189136362039, 20: 0.9752475247524751}
Pin Pointing mAP: 0.9782806591917599
------------------
mAP detection saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer3.csv
Detection mAP: {'map': tensor(0.5297), 'map_50': tensor(0.5297), 'map_75': tensor(-1.), 'map_small': tensor(-1.), 'map_medium': tensor(-1.), 'map_large': tensor(0.5498), 'mar_1': tensor(0.6459), 'mar_10': tensor(0.6824), 'mar_100': tensor(0.6824), 'mar_small': tensor(-1.), 'mar_medium': tensor(-1.), 'mar_large': tensor(0.6824), 'map_per_class': tensor([0.5369, 0.8180, 0.3544, 0.2824, 0.3590, 0.3562, 0.7342, 0.5738, 0.0337,
        0.7017, 0.7599, 0.4717, 0.5209, 0.7809, 0.6604, 0.5096, 0.8908, 0.5792,
        0.5913, 0.0792]), 'mar_100_per_class': tensor([0.7403, 0.8889, 0.5378, 0.5000, 0.6154, 0.6190, 0.8477, 0.7345, 0.2857,
        0.7500, 0.8000, 0.6457, 0.6667, 0.8000, 0.8137, 0.6087, 0.9286, 0.8043,
        0.6949, 0.3667]), 'classes': tensor([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
        19, 20], dtype=torch.int32)}
------------------
mAP classification saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer3.csv
Classification mAP: 0.9279505014419556
Classification AP: tensor([   nan, 0.9914, 0.9863, 0.9993, 0.9347, 0.8764, 0.9632, 0.9826, 0.9958,
        0.2107, 0.9410, 0.8868, 0.9918, 0.9509, 0.9782, 0.9935, 0.9638, 0.9722,
        0.9718, 0.9956, 0.9730])
-----------------------------------------------------------------------------
Evaluating data split multi_instance_dataset:
mAP pin pointing saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer3.csv
Pin Pointing AP per class: {1: 0.32673267326732675, 2: 0.6919441944194419, 3: 0.23721687237216874, 4: 0.2611981399215442, 5: 0.20486893306422763, 6: 0.7697856956748306, 7: 0.36972382423980216, 8: 0.5590251332825591, 9: 0.42052330233023305, 10: 0.3809327515626661, 11: 0.0, 12: 0.7246057939127246, 13: 0.5643564356435643, 14: 0.5114540865851291, 15: 0.3415841584158416, 16: 0.3225725395831665, 17: 0.22772277227722773, 18: 0.7430280528052805, 19: 0.693069306930693, 20: 0.4967624479839288}
Pin Pointing mAP: 0.44235535571361784
------------------
mAP detection saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer3.csv
Detection mAP: {'map': tensor(0.0580), 'map_50': tensor(0.0580), 'map_75': tensor(-1.), 'map_small': tensor(0.), 'map_medium': tensor(0.0085), 'map_large': tensor(0.1615), 'mar_1': tensor(0.0874), 'mar_10': tensor(0.1015), 'mar_100': tensor(0.1015), 'mar_small': tensor(0.), 'mar_medium': tensor(0.0121), 'mar_large': tensor(0.3211), 'map_per_class': tensor([ 5.2859e-02,  2.0792e-01,  2.4745e-02,  1.9163e-03,  4.7148e-04,
         1.0641e-01,  3.9729e-02,  8.9870e-02,  2.6803e-03,  2.8078e-02,
        -1.0000e+00,  1.2734e-01,  1.0007e-01,  8.7459e-02,  3.1178e-02,
         1.1361e-02,  3.5474e-03,  3.1503e-03,  1.5515e-01,  2.7418e-02]), 'mar_100_per_class': tensor([ 0.1071,  0.2143,  0.0397,  0.0178,  0.0040,  0.1667,  0.0902,  0.1791,
         0.0268,  0.0423, -1.0000,  0.2083,  0.1538,  0.1707,  0.0869,  0.0390,
         0.0176,  0.0667,  0.2143,  0.0833]), 'classes': tensor([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
        19, 20], dtype=torch.int32)}
------------------
mAP classification saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer3.csv
Classification mAP: 0.8591462969779968
Classification AP: tensor([   nan, 0.9965, 0.9196, 0.9673, 0.9780, 0.8368, 0.7700, 0.9829, 0.9855,
        0.5703, 0.8824,    nan, 0.9365, 0.6592, 0.9196, 0.9914, 0.9335, 0.9496,
        0.3101, 0.9667, 0.7679])
-----------------------------------------------------------------------------
Evaluating data split multi_class_dataset:
mAP pin pointing saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer3.csv
Pin Pointing AP per class: {1: 0.8811881188118812, 2: 0.5758900936866023, 3: 0.15762826282628264, 4: 0.4767111756253159, 5: 0.3336347920993538, 6: 0.7158020493710922, 7: 0.4598329478925076, 8: 0.7421728659352421, 9: 0.39094911495211787, 10: 0.3567185289957567, 11: 0.8840366458204332, 12: 0.7011623403784087, 13: 0.7418090500209192, 14: 0.6444122769929753, 15: 0.3416498358021877, 16: 0.34296410156162055, 17: 0.32673267326732675, 18: 0.8995484820967115, 19: 0.8889812155657757, 20: 0.5717041889716685}
Pin Pointing mAP: 0.5716764380337089
------------------
mAP detection saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer3.csv
Detection mAP: {'map': tensor(0.1027), 'map_50': tensor(0.1027), 'map_75': tensor(-1.), 'map_small': tensor(0.), 'map_medium': tensor(0.0076), 'map_large': tensor(0.2310), 'mar_1': tensor(0.1644), 'mar_10': tensor(0.1796), 'mar_100': tensor(0.1796), 'mar_small': tensor(0.), 'mar_medium': tensor(0.0177), 'mar_large': tensor(0.4444), 'map_per_class': tensor([0.4594, 0.0605, 0.0099, 0.0221, 0.0072, 0.1399, 0.0888, 0.2407, 0.0016,
        0.0162, 0.1360, 0.1292, 0.2035, 0.1584, 0.0316, 0.0046, 0.0050, 0.0952,
        0.2331, 0.0112]), 'mar_100_per_class': tensor([0.5476, 0.1577, 0.0116, 0.0909, 0.0130, 0.2500, 0.1402, 0.3367, 0.0251,
        0.0761, 0.2768, 0.2346, 0.3333, 0.2630, 0.0935, 0.0367, 0.0169, 0.2630,
        0.3770, 0.0484]), 'classes': tensor([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
        19, 20], dtype=torch.int32)}
------------------
mAP classification saved to logs/evaluate_test_fpn_classifier_pascal_2007_final_layer3.csv
Classification mAP: 0.8100964426994324
Classification AP: tensor([   nan, 0.9328, 0.9216, 0.4347, 0.9126, 0.6176, 0.9146, 0.8541, 0.8031,
        0.8094, 0.7159, 0.8332, 0.8248, 0.9785, 0.9006, 0.9848, 0.6148, 0.6514,
        0.7882, 0.8822, 0.8270])
--------------------------------------------------------------------------------------------------
Evaluation on trainval set
Using downloaded and verified file: ../data/pascal_voc_2007\VOCtrainval_06-Nov-2007.tar
Extracting ../data/pascal_voc_2007\VOCtrainval_06-Nov-2007.tar to ../data/pascal_voc_2007
Running on Quadro T1000 with Max-Q Design
Evaluation:   0%|          | 0/5011 [00:00<?, ?it/s]Model loaded from pretrained_models/fpn_classifier_pascal_2007_final_layer3.pth
Evaluation: 100%|██████████| 5011/5011 [33:12<00:00,  2.51it/s]
Evaluation time saved to logs/evaluate_train_fpn_classifier_pascal_2007_final_layer3.csv
-----------------------------------------------------------------------------
Evaluating data split full_dataset:
CorLoc saved to logs/evaluate_train_fpn_classifier_pascal_2007_final_layer3.csv
CorLoc per class: {9: 0.07232401157184185, 11: 0.2224622030237581, 7: 0.30275229357798167, 13: 0.38580246913580246, 15: 0.25, 2: 0.2787456445993031, 8: 0.5297297297297298, 12: 0.40702479338842973, 19: 0.46645367412140576, 1: 0.4881889763779528, 5: 0.05614973262032086, 20: 0.05897435897435897, 3: 0.3190883190883191, 14: 0.4006849315068493, 16: 0.13411078717201166, 4: 0.16071428571428573, 18: 0.22706065318818042, 10: 0.358974358974359, 17: 0.23931623931623933, 6: 0.25475285171102663}
Mean CorLoc: 0.2806655156896078
-----------------------------------------------------------------------------
Evaluating data split localization_dataset:
CorLoc saved to logs/evaluate_train_fpn_classifier_pascal_2007_final_layer3.csv
CorLoc per class: {7: 0.5807692307692308, 2: 0.6229508196721312, 19: 0.4858757062146893, 12: 0.5283018867924528, 20: 0.10679611650485436, 3: 0.42857142857142855, 8: 0.6473214285714286, 15: 0.5165876777251185, 1: 0.5269461077844312, 4: 0.14492753623188406, 6: 0.5, 9: 0.08108108108108109, 18: 0.2875, 10: 0.5957446808510638, 13: 0.627906976744186, 14: 0.47619047619047616, 17: 0.46, 5: 0.325, 16: 0.46153846153846156, 11: 0.18181818181818182}
Mean CorLoc: 0.4292913898530549
-----------------------------------------------------------------------------
Evaluating data split small_localization_dataset:
CorLoc saved to logs/evaluate_train_fpn_classifier_pascal_2007_final_layer3.csv
CorLoc per class: {19: 0.0, 7: 0.013888888888888888, 20: 0.0, 3: 0.01, 15: 0.0, 8: 0.0, 9: 0.02564102564102564, 18: 0.07142857142857142, 6: 0.0625, 10: 0.058823529411764705, 14: 0.0, 1: 0.03389830508474576, 17: 0.0, 4: 0.0, 12: 0.05555555555555555, 2: 0.16666666666666666, 5: 0.0, 13: 0.0, 16: 0.0, 11: 0.0}
Mean CorLoc: 0.02492012713386093
-----------------------------------------------------------------------------
Evaluating data split large_localization_dataset:
CorLoc saved to logs/evaluate_train_fpn_classifier_pascal_2007_final_layer3.csv
CorLoc per class: {7: 0.7978723404255319, 2: 0.813953488372093, 12: 0.625, 3: 0.7480916030534351, 8: 0.7435897435897436, 1: 0.7962962962962963, 19: 0.7166666666666667, 4: 0.3448275862068966, 6: 0.6944444444444444, 15: 0.6770186335403726, 20: 0.1864406779661017, 13: 0.6923076923076923, 5: 0.5, 16: 0.5625, 10: 0.9, 14: 0.5769230769230769, 9: 0.14285714285714285, 18: 0.3333333333333333, 17: 0.6571428571428571, 11: 0.3333333333333333}
Mean CorLoc: 0.5921299458229509
-----------------------------------------------------------------------------
Evaluating data split multi_instance_dataset:
CorLoc saved to logs/evaluate_train_fpn_classifier_pascal_2007_final_layer3.csv
CorLoc per class: {9: 0.03389830508474576, 11: 0.0, 8: 0.4, 1: 0.22727272727272727, 19: 0.4782608695652174, 16: 0.14473684210526316, 7: 0.3160919540229885, 4: 0.13043478260869565, 15: 0.33238636363636365, 14: 0.47619047619047616, 12: 0.27450980392156865, 18: 0.28, 20: 0.0, 17: 0.06521739130434782, 3: 0.0975609756097561, 10: 0.26666666666666666, 13: 0.07692307692307693, 6: 0.15789473684210525, 5: 0.05, 2: 0.0}
Mean CorLoc: 0.19040224858769997
-----------------------------------------------------------------------------
Evaluating data split multi_class_dataset:
CorLoc saved to logs/evaluate_train_fpn_classifier_pascal_2007_final_layer3.csv
CorLoc per class: {13: 0.3619402985074627, 15: 0.20950118764845604, 12: 0.3212669683257919, 2: 0.1935483870967742, 1: 0.6046511627906976, 5: 0.02040816326530612, 11: 0.23653395784543327, 20: 0.046511627906976744, 8: 0.3333333333333333, 7: 0.1663619744058501, 14: 0.3701923076923077, 9: 0.07411504424778761, 4: 0.19767441860465115, 16: 0.07456140350877193, 18: 0.21561338289962825, 10: 0.24489795918367346, 17: 0.09523809523809523, 6: 0.19791666666666666, 19: 0.4222222222222222, 3: 0.13157894736842105}
Mean CorLoc: 0.2259033754379154